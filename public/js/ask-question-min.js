var askQuestion=function(){var t={paths:{getCourses:config.ajaxPath+"/getCourses.php",postQuestion:config.ajaxPath+"/postQuestion.php"},subjectSelector:$("#target-selector-course"),setCourseModal:$("#set-course"),courseSearchField:$("#course-search"),courseSearchResults:$("#course-search-results"),targetRadio:$(".target-radio"),postQuestionButton:$("#post-question"),questionEditor:$("#editor"),questionTitle:$("#title")},e=function(){$.initWysiwyg(),$("select").selectpicker(),t.select=$(".bootstrap-select"),t.subjectSelector.click(o),t.postQuestionButton.click(i),t.questionTitle.validify({position:"top"}),t.select.validify({position:"top"}),t.subjectSelector.validify({position:"top"}),t.questionEditor.validify({position:"top"}),t.postQuestionButton.validify({position:"right"}),t.questionTitle.mustFollow([{rule:function(t){return t.length>=15},html:"The title must have at least 15 characters"}]),t.subjectSelector.mustFollow([{rule:function(t){return parseInt(t,10)},html:"Please select a subject."}]),t.questionEditor.mustFollow([{rule:function(){return!0}}])},o=function(e){e.preventDefault(),t.setCourseModal.modal("show"),s(),t.courseSearchField.attr("placeholder","Subject of Question"),setTimeout(function(){t.courseSearchField.focus()},500),t.courseSearchField.keyup(function(){s()})},s=function(){$.ajax({method:"GET",cache:!1,url:t.paths.getCourses,data:{query:t.courseSearchField.val()},success:function(e){t.courseSearchResults.html(e),$(".course-suggestion").click(function(){var e=$(this).find(".course-name").text(),o=$(this).data("course");t.setCourseModal.modal("hide"),t.subjectSelector.removeClass("btn-primary").addClass("btn-success").html(e).val(o).trigger("change")})}})},i=function(e){e.preventDefault();var o;$.ajax({method:"POST",url:t.paths.postQuestion,data:{target:o,courseID:t.subjectSelector.val(),title:$("#title").val(),postBody:t.questionEditor.cleanHtml()},success:function(e){var o=$.parseJSON(e);o.success?document.location.href="../?id="+o.postID:(t.questionTitle.validify(o.title,function(t){t.parent().addClass("has-error")}),t.questionEditor.validify(o.body,function(t){t.parent().addClass("has-error")}),t.subjectSelector.validify(o.subjectSelector,function(t){t.parent().addClass("has-error")}))},error:function(){t.postQuestionButton.displayError()}})};return{init:e}}();$(function(){askQuestion.init()});